- added documentation for iMain()
- reduced code complexity of imain() and a few other functions
- improved code hygiene